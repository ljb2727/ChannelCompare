<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Channel Compare | 유튜브 채널 비교 분석</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="glass-header">
            <div class="logo">
                <i class="fa-solid fa-scale-balanced"></i>
                <span>Channel Compare</span>
            </div>
            <div class="header-actions">
                <button id="apiKeyBtn" class="icon-btn" title="API 설정">
                    <i class="fa-solid fa-key"></i> API 키 설정
                </button>
            </div>
        </header>

        <main>
            <!-- Hero / Search Section -->
            <section class="search-section">
                <h1>유튜브 채널 비교 분석</h1>
                <p>최대 5개의 채널을 추가하여 상세 데이터를 비교해보세요.</p>
                
                <div class="search-box-container">
                    <div class="search-box">
                        <i class="fa-brands fa-youtube search-icon"></i>
                        <input type="text" id="searchInput" placeholder="채널명 또는 채널 핸들(@handle) 입력">
                        <button id="searchBtn">검색</button>
                    </div>
                </div>

                <!-- Selected Channels List -->
                <div id="selectedChannels" class="selected-channels">
                    <!-- Channel chips will be added here -->
                    <div class="placeholder-chip">비교할 채널을 검색하여 추가하세요 (0/5)</div>
                </div>

                <button id="compareBtn" class="compare-btn" disabled>
                    분석 시작하기
                </button>
            </section>

            <!-- Loading State -->
            <div id="loadingState" class="hidden">
                <div class="loader"></div>
                <p>채널 데이터를 분석하고 있습니다...</p>
            </div>

            <!-- Dashboard Section -->
            <section id="dashboard" class="dashboard-section hidden">
                
                <!-- 0. Overall Score & Ranking -->
                <div class="card">
                    <div class="card-header">
                        <h2>
                            🏅 채널 종합 점수 & 순위
                            <i class="fa-solid fa-circle-info info-icon" id="scoreInfoBtn" title="평가 기준 보기" style="font-size: 0.9rem; margin-left: 0.5rem; cursor: pointer; color: var(--text-secondary);"></i>
                        </h2>
                        <p>구독자, 조회수, 성장성, 일관성, 참여도를 종합 평가</p>
                    </div>
                    <div id="overallScoreContainer" class="overall-score-grid">
                        <!-- Score cards will be injected here -->
                    </div>
                </div>

                <!-- 1. Core Metrics Table -->
                <div class="card metrics-card">
                    <div class="card-header">
                        <div class="tooltip-bubble">
                            💡 비교할 영상 종류를 선택하세요.
                        </div>
                        <h2>📊 핵심 지표 비교</h2>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">전체</button>
                            <button class="filter-btn" data-filter="short">📱 숏폼만 (≤3분)</button>
                            <button class="filter-btn" data-filter="long">🎬 롱폼만 (>3분)</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="metricsTable">
                            <thead>
                                <tr>
                                    <th>채널</th>
                                    <th>구독자</th>
                                    <th>총 조회수</th>
                                    <th>동영상 수</th>
                                    <th>평균 조회수 (최근 30개)</th>
                                    <th>
                                        조회수 등락 
                                        <i class="fa-solid fa-circle-info info-icon" id="engagementInfo" title="등락률 정보"></i>
                                    </th>
                                    <th>평균 업로드 주기</th>
                                    <th>채널 개설일</th>
                                    <th>📱 숏폼 / 🎬 롱폼</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data rows -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 2. Visual Analysis Row (Radar + Scatter) -->
                <div class="charts-grid">
                    <!-- Radar Chart -->
                    <div class="card col-span-2">
                        <div class="card-header">
                            <h2>🕸️ 채널 밸런스</h2>
                            <p>5가지 항목 상대 평가</p>
                        </div>
                        <div class="radar-layout">
                            <div class="chart-container" style="flex: 1; min-height: 400px;">
                                <canvas id="radarChart"></canvas>
                            </div>
                            <div class="radar-info">
                                <h3>📊 평가 기준 상세</h3>
                                <div class="info-list">
                                    <div class="info-item-row">
                                        <span class="icon">🔥</span>
                                        <div class="text">
                                            <strong>성과 (Performance)</strong>
                                            <p>최근 30개 영상의 평균 조회수를 기반으로 평가합니다.</p>
                                        </div>
                                    </div>
                                    <div class="info-item-row">
                                        <span class="icon">🤝</span>
                                        <div class="text">
                                            <strong>참여 (Engagement)</strong>
                                            <p>조회수 대비 좋아요 및 댓글 비율을 분석합니다.</p>
                                        </div>
                                    </div>
                                    <div class="info-item-row">
                                        <span class="icon">👁️</span>
                                        <div class="text">
                                            <strong>규모 (Scale)</strong>
                                            <p>구독자 수와 채널의 총 누적 조회수를 반영합니다.</p>
                                        </div>
                                    </div>
                                    <div class="info-item-row">
                                        <span class="icon">📈</span>
                                        <div class="text">
                                            <strong>성장 (Growth)</strong>
                                            <p>최근 영상들의 조회수 상승/하락 추세를 평가합니다.</p>
                                        </div>
                                    </div>
                                    <div class="info-item-row">
                                        <span class="icon">📅</span>
                                        <div class="text">
                                            <strong>활동 (Activity)</strong>
                                            <p>영상의 업로드 빈도와 규칙성을 평가합니다.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Scatter Chart -->
                    <div class="card col-span-2">
                        <div class="card-header">
                            <h2>📏 영상 길이 vs 조회수</h2>
                            <p>영상 길이(분)에 따른 조회수 분포 (로그 스케일)</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="lengthVsViewsChart"></canvas>
                        </div>
                    </div>

                    <!-- Growth Trend Chart -->
                    <div class="card col-span-2">
                        <div class="card-header">
                            <h2>📈 채널 성장 추세</h2>
                            <p>최근 30일간의 조회수 변화 추이</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="growthTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- 3. Pattern Analysis Row (Upload Pattern Only) -->
                <div class="charts-grid" style="margin-top: 2rem;">
                    <!-- Upload Pattern -->
                    <div class="card col-span-2">
                        <div class="card-header">
                            <h2>📅 업로드 패턴</h2>
                            <p>요일별/시간대별 업로드 빈도 (진할수록 많음)</p>
                        </div>
                        <div id="heatmapContainer" class="heatmap-container">
                            <!-- Heatmaps will be injected here -->
                        </div>
                    </div>
                </div>

                <!-- 4. Text Analysis (Keywords) -->
                <div class="card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <h2>🔑 주요 키워드</h2>
                        <p>영상 제목과 설명에서 자주 사용되는 단어</p>
                    </div>
                    <div id="keywordsContainer" class="keywords-grid">
                        <!-- Keyword chips will be injected here -->
                    </div>
                </div>

                <!-- 4.5. Recent Videos Comparison -->
                <div class="card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <h2>🎬 최근 영상 비교</h2>
                        <p>각 채널의 최근 5개 영상 상세 정보</p>
                    </div>
                    <div id="recentVideosContainer" class="recent-videos-container">
                        <!-- Recent videos will be injected here -->
                    </div>
                </div>

                <!-- 5. Best Videos (Compact Gallery) -->
                <div class="card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <h2>🏆 채널별 대표 영상</h2>
                        <p>최근 영상 중 조회수가 가장 높은 영상</p>
                    </div>
                    <div id="bestVideosContainer" class="video-grid-compact">
                        <!-- Video cards will be injected here -->
                    </div>
                </div>

            </section>
        </main>

        <!-- API Key Modal -->
        <div id="apiModal" class="modal hidden">
            <div class="modal-content">
                <h2>API 설정</h2>
                <p>YouTube Data API Key가 필요합니다.</p>
                <div class="input-group">
                    <input type="text" id="apiKeyInput" placeholder="API Key 입력">
                </div>
                <div class="modal-actions">
                    <button id="closeApiBtn" class="btn-secondary">닫기</button>
                    <button id="saveApiBtn" class="btn-primary">저장</button>
                </div>
            </div>
        </div>

        <!-- Growth Rate Info Modal -->
        <div id="engagementModal" class="modal hidden">
            <div class="modal-content">
                <h2>📈 조회수 등락이란?</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    최근 업로드한 영상들이 과거 영상들에 비해 조회수가 상승하고 있는지 보여주는 지표입니다.
                </p>
                <div style="background: rgba(34, 197, 94, 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 3px solid var(--success-color);">
                    <strong>계산 방식:</strong><br>
                    (최근 5개 평균 조회수 - 그 전 5개 평균 조회수) ÷ 그 전 평균 조회수
                </div>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                    <strong>해석:</strong><br>
                    • <span style="color: var(--success-color);"><strong>+ (양수):</strong></span> 최근 영상들의 조회수가 상승세입니다.<br>
                    • <span style="color: var(--danger-color);"><strong>- (음수):</strong></span> 최근 영상들의 조회수가 하락세입니다.<br>
                    • <strong>0%:</strong> 조회수 변동이 거의 없습니다.
                </p>
                <div class="modal-actions">
                    <button id="closeEngagementBtn" class="btn-primary">확인</button>
                </div>
            </div>
        </div>

        <!-- Score Criteria Info Modal -->
        <div id="scoreModal" class="modal hidden">
            <div class="modal-content" style="max-width: 500px;">
                <h2>📊 종합 점수 평가 기준</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    각 채널은 5가지 항목을 기준으로 100점 만점으로 평가됩니다.
                </p>
                
                <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="score-criteria-item">
                        <div style="font-weight: 700; color: #3b82f6; margin-bottom: 0.25rem;">1. 규모 (30%)</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">구독자 수를 기준으로 평가합니다. (100만 명 이상 시 만점)</div>
                    </div>
                    <div class="score-criteria-item">
                        <div style="font-weight: 700; color: #8b5cf6; margin-bottom: 0.25rem;">2. 성과 (30%)</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">최근 영상들의 평균 조회수를 기준으로 평가합니다. (50만 회 이상 시 만점)</div>
                    </div>
                    <div class="score-criteria-item">
                        <div style="font-weight: 700; color: #ec4899; margin-bottom: 0.25rem;">3. 성장 (20%)</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">최근 조회수 상승세를 평가합니다. (상승폭이 클수록 고득점)</div>
                    </div>
                    <div class="score-criteria-item">
                        <div style="font-weight: 700; color: #22c55e; margin-bottom: 0.25rem;">4. 참여 (10%)</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">조회수 대비 좋아요 비율을 평가합니다. (5% 이상 시 만점)</div>
                    </div>
                    <div class="score-criteria-item">
                        <div style="font-weight: 700; color: #fbbf24; margin-bottom: 0.25rem;">5. 활동 (10%)</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">영상 업로드 주기를 평가합니다. (1일 1영상 시 만점)</div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="closeScoreBtn" class="btn-primary">확인</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
